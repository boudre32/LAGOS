---
title: "Using SQLite with LAGOS"
author: "Joseph Stachelek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using SQLite with LAGOS}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Compile `txt` files to `sqlite`

```{r eval=FALSE}
library(LAGOS)
library(magrittr)
```

The `LAGOS` `sqlite` commands require some packages not yet available from CRAN. The development versions of the `DBI` and `RSQLite` packages can be installed by running the following commands from the R console:

```{r eval = FALSE}
devtools::install_github("rstats-db/DBI")
devtools::install_github("rstats-db/RSQLite")
```

To install from Github, you'll need a [development environment](https://support.rstudio.com/hc/en-us/articles/200486498-Package-Development-Prerequisites).


```{r eval = FALSE}
lagos_compile(version = "1.087.0", format = "sqlite",
              limno_folder = "~/Downloads/Version1.087.0/",
              geo_folder   = "~/Downloads/LAGOS_VER1.04/")
```

### Load compiled `sqlite` object

```{r eval=FALSE}
dt_sqlite <- lagos_load(version = "1.087.0", format = "sqlite")
```

### Select desired table-columns from `sqlite`

```{r eval=FALSE}
epi.nutr <- dplyr::tbl(dt_sqlite, "epi.nutr") %>%
              dplyr::select(lagoslakeid, tp, tn)

iws.lulc <- dplyr::tbl(dt_sqlite, "iws.lulc") %>%
              dplyr::select(iws_lagoslakeid, iws_nlcd2011_pct_95)

dt_sqlite <- dplyr::left_join(epi.nutr, iws.lulc,
                  by = c("lagoslakeid" = "iws_lagoslakeid"))
```
