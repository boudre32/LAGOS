---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

<h1 align="left">
<img width="800" src="./inst/lagos_banner.png" alt="">
</h1>

[![Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](http://www.repostatus.org/badges/latest/wip.svg)](http://www.repostatus.org/#wip)
[![CRAN\_Status\_Badge](http://www.r-pkg.org/badges/version/LAGOS)](https://cran.r-project.org/package=LAGOS) 
[![CRAN RStudio mirror downloads](http://cranlogs.r-pkg.org/badges/LAGOS)](https://cran.r-project.org/package=LAGOS)

The `LAGOS` package provides an R interface to download LAGOS data from remote databases, store this data locally, and perform a variety of filtering and subsetting operations.

## Installation

> This process will be much simpler after the package is made public.

### From RStudio

#### GUI

New Project -> Version Control -> Git ->

`https://github.com/cont-limno/LAGOS.git` -> Create Project

#### R prompt/console

`devtools::install()`
 
### Data

Until the data exports have been loaded to the LTER data-store users must supply their `locus`, `limno` and `geo` data folders paths to the `lagos_compile` function (see example below). Eventually, users will be able to run `lagos_get` to supply `lagos_compile` with the flat files from LTER without having to deal with file paths. The __output__ of `lagos_get` and `lagos_compile` is stored in the location returned by `rappdirs::user_data_dir`.

### Compile flat files

```{r eval=FALSE} 
library(LAGOS)
lagos_compile("1.087.1", format = "rds",
  limno_folder = "~/Downloads/LAGOS-NE-LIMNO-EXPORT",
  geo_folder   = "~/Downloads/LAGOS-NE-GEO-EXPORT",
  locus_folder = "~/Downloads/LAGOS-NE-LOCUS-EXPORT")
```

## Usage

### Load Package

```{r } 
library(LAGOS)
```

### Load data

```{r }
dt <- lagos_load(version = "1.087.1", format = "rds")
names(dt)
```

#### Preview a table

```{r }
head(dt$county)
```

#### Read table metadata

```{r Read metadata for individual tables}
help.search("datasets", package = "LAGOS")
```

### Select data

See [here](http://adv-r.had.co.nz/Subsetting.html) for a comprehensive tutorial on generic `data.frame` subsetting.

```{r }
# specific variables
 head(lagos_select(table = "epi.nutr", vars = c("tp", "tn")))
 head(lagos_select(table = "iws.lulc", vars = c("iws_nlcd2011_pct_95")))

# categories
head(lagos_select(table = "epi.nutr", categories = "waterquality"))
head(lagos_select(table = "county.chag", categories = "hydrology"))
head(lagos_select(table = "hu4.chag", categories = "deposition")[,1:4])

# mix of specific variables and categories
head(lagos_select(table = "epi.nutr", vars = "lagoslakeid", categories = c("waterquality")))
```

## Published LAGOS subsets

```{r eval = FALSE}
# Oliver et al. 2015
lagos_get_oliver_2015()
```

```{r }
dt <- lagos_load_oliver_2015()
head(dt)
```

## Legacy code-base

The legacy code-base (minus the data) can be obtained by running the following commands in your shell:

```{shell eval=FALSE}
git clone https://github.com/cont-limno/LAGOS.git 

cd LAGOS

git checkout 553b0ba3875b29257aab1aaec71d3388070bd3e5
```

## References

Soranno, P.A., Bissell, E.G., Cheruvelil, K.S., Christel, S.T., Collins,
  S.M., Fergus, C.E., Filstrup, C.T., Lapierre, J.F., Lottig, N.R., Oliver,
  S.K., Scott, C.E., Smith, N.J., Stopyak, S., Yuan, S., Bremigan, M.T.,
  Downing, J.A., Gries, C., Henry, E.H., Skaff, N.K., Stanley, E.H.,
  Stow, C.A., Tan, P.N., Wagner, T. and Webster, K.E. 2015. Building a
  multi-scaled geospatial temporal ecology database from disparate data
  sources: fostering open science and data reuse. _Gigascience_, 4(1)

Oliver SK, Soranno PA, Fergus CE, Wagner T, Webster K, Scott C, Winslow LA,      Downing J, Stanley EH. 2015. LAGOS - Predicted and observed maximum depth      values for lakes in a 17-state region of the U.S. DOI:                         10.6073/pasta/edc06bbae6db80e801b6e52253f2ea09
